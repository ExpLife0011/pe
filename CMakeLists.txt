CMAKE_MINIMUM_REQUIRED(VERSION 2.4)

PROJECT(pe)

#CONFIGURE_FILE(peConfig.cmake.in "${CMAKE_SOURCE_DIR}/peConfig.cmake")

#util
IF (NOT util_SOURCE_DIR)
	ADD_SUBDIRECTORY(util)
ENDIF (NOT util_SOURCE_DIR)
INCLUDE_DIRECTORIES("${util_SOURCE_DIR}")
LINK_DIRECTORIES("${util_BINARY_DIR}")

SET(SRC_LIST
pe.cpp
slist.cpp)

#static library
ADD_LIBRARY(pe_static STATIC ${SRC_LIST})
SET_TARGET_PROPERTIES(pe_static PROPERTIES OUTPUT_NAME "pe" PREFIX "lib")
SET_TARGET_PROPERTIES(pe_static PROPERTIES CLEAN_DIRECT_OUTPUT 1)

#tool 
SET(TOOL_SRC_LIST
petool.cpp)

ADD_EXECUTABLE(petool ${TOOL_SRC_LIST})
TARGET_LINK_LIBRARIES(petool pe_static)
TARGET_LINK_LIBRARIES(petool util_static)

#install
INSTALL(TARGETS pe_static
	ARCHIVE DESTINATION lib)
#install(EXPORT pelib DESTINATION "pelib")
INSTALL(FILES pe.h DESTINATION include)
INSTALL(FILES imgfmt.h DESTINATION include)	
INSTALL(TARGETS petool RUNTIME DESTINATION bin)




